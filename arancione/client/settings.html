<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings - Bflash</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="style.css"> <style>
        /* Add specific styles for settings page here or in style.css */
        .settings-container {
            max-width: 800px;
            margin: 40px auto;
            padding: 30px;
            background-color: var(--gray-light); /* Use existing variable */
            border-radius: 16px;
            box-shadow: 0 4px 12px var(--shadow-color);
        }

        .settings-section {
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--gray);
        }
        .settings-section:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .settings-section h2 {
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--primary);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 14px;
        }

        /* Reuse existing form input style */
        /* .form-input { ... } */
        .form-input {
            width: 100%;
            padding: 12px 16px;
            border-radius: 12px;
            border: none;
            background-color: var(--gray);
            color: var(--text);
            font-size: 15px;
            margin-bottom: 16px;
        }

        textarea.form-input {
            min-height: 100px;
            resize: vertical;
        }

        /* Reuse existing button style */
        /* .auth-button { ... } */

        .auth-button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .settings-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        .settings-toggle label {
             margin-bottom: 0;
        }
        /* Basic toggle switch - enhance as needed */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        .toggle-switch input {display: none;}
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: var(--gray);
            transition: .4s;
            border-radius: 24px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 18px; width: 18px;
            left: 3px; bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider { background-color: var(--primary); }
        input:checked + .slider:before { transform: translateX(26px); }


        .legal-links a {
            display: block;
            margin-bottom: 10px;
            color: var(--text);
            text-decoration: none;
        }
        .legal-links a:hover {
            color: var(--primary);
        }

        .danger-zone {
            border-top: 1px solid #dc3545; /* Red border */
            padding-top: 20px;
            margin-top: 30px;
        }
        .danger-zone h2 {
            color: #dc3545; /* Red title */
        }
        .danger-zone p {
            margin-bottom: 15px;
            font-size: 14px;
            color: var(--text-light);
        }
        .delete-button {
            background-color: #dc3545; /* Red background */
            color: white;
            border: none;
            /* Reuse padding/font styles from auth-button if desired */
            padding: 12px 20px;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .delete-button:hover {
            background-color: #c82333; /* Darker red */
        }

        .message {
            padding: 10px;
            margin-bottom: 15px;
            border-radius: 8px;
            font-size: 14px;
            display: none; /* Hidden by default */
        }
        .message.success {
            background-color: rgba(40, 167, 69, 0.2); /* Light green */
            color: #28a745;
            border: 1px solid #28a745;
        }
        .message.error {
             background-color: rgba(220, 53, 69, 0.1); /* Light red */
             color: #dc3545;
             border: 1px solid #dc3545;
        }

    </style>
</head>
<body>
    <header>
        <a href="index.html" style="text-decoration: none; color: inherit;">
             <div class="logo">
                 <div class="logo-circle"><i class="fas fa-bolt"></i></div>
                 <div class="app-name">Bflash</div>
             </div>
        </a>
        <div class="search-profile">
            <div class="profile-icon" id="profile-menu-button">
                <i class="fas fa-user"></i>
            </div>
            <div class="profile-dropdown" id="profile-dropdown" style="display: none;">
                <div class="dropdown-item" id="username-display">Username</div>
                <div class="dropdown-item"><a href="index.html" style="color: inherit; text-decoration: none;">Home</a></div>
                <div class="dropdown-item" id="logout-button"><i class="fas fa-sign-out-alt"></i> Logout</div>
            </div>
        </div>
    </header>

    <div class="settings-container">
        <h1>Settings</h1>

        <section class="settings-section">
            <h2>Appearance</h2>
            <div class="settings-toggle">
                <label for="dark-mode-toggle" class="form-label">Light Mode</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="dark-mode-toggle">
                    <span class="slider"></span>
                </label>
            </div>
            <div class="form-group">
                <label class="form-label">Theme Color (Coming Soon)</label>
                 <p style="font-size: 14px; color: var(--text-light);">Select your preferred theme color.</p>
            </div>
        </section>

        <section class="settings-section">
            <h2>Account</h2>
            <form id="profile-form">
                <div class="form-group">
                    <label for="profile-username" class="form-label">Username</label>
                    <input type="text" id="profile-username" class="form-input" placeholder="Enter your new username" required>
                </div>
                <div class="form-group">
                    <label for="profile-bio" class="form-label">Bio</label>
                    <textarea id="profile-bio" class="form-input" placeholder="Tell us a little about yourself..."></textarea>
                </div>
                <div id="profile-message" class="message"></div>
                <button type="submit" class="auth-button">Update Profile</button>
            </form>
            <hr style="border-color: var(--gray); margin: 30px 0;">
            <form id="password-form">
                 <label class="form-label" style="font-size: 16px; font-weight: 600; margin-bottom: 15px;">Change Password</label>
                <div class="form-group">
                    <label for="current-password" class="form-label">Current Password</label>
                    <input type="password" id="current-password" class="form-input" required>
                </div>
                <div class="form-group">
                    <label for="new-password" class="form-label">New Password</label>
                    <input type="password" id="new-password" class="form-input" required minlength="6">
                </div>
                <div class="form-group">
                    <label for="confirm-password" class="form-label">Confirm New Password</label>
                    <input type="password" id="confirm-password" class="form-input" required>
                </div>
                <div id="password-message" class="message"></div>
                <button type="submit" class="auth-button">Change Password</button>
            </form>
        </section>

        <section class="settings-section">
            <h2>Legal</h2>
            <div class="legal-links">
                <a href="#" id="privacy-policy-link">Privacy Policy</a>
                <a href="#" id="terms-service-link">Terms of Service</a>
                <a href="#" id="cookie-policy-link">Cookie Policy</a>
            </div>
        </section>

        <section class="danger-zone">
            <h2>Danger Zone</h2>
            <p>Deleting your account is permanent and cannot be undone. All your decks, sets, and cards will be removed.</p>
            <button id="delete-account-button" class="delete-button">Delete My Account</button>
             <div id="delete-message" class="message error"></div>
        </section>

    </div>
    <div id="privacy-policy-modal" class="modal" style="display: none;">
        <div class="modal-content legal-modal">
            <span class="close-modal" data-modal-id="privacy-policy-modal">&times;</span>
            <h2>Privacy Policy</h2>
            <div class="modal-body">
                <p><strong>Last Updated: 04/05/2025</strong></p>
                <p>Your privacy is important to us. It is Bflash's policy to respect your privacy regarding any information we may collect from you across our website.</p>
                <p>We only ask for personal information when we truly need it to provide a service to you. We collect it by fair and lawful means, with your knowledge and consent. We also let you know why we are collecting it and how it will be used.</p>
                <p>We only retain collected information for as long as necessary to provide you with your requested service. What data we store, we will protect within commercially acceptable means to prevent loss and theft, as well as unauthorized access, disclosure, copying, use or modification.</p>
                <p>We donâ€™t share any personally identifying information publicly or with third-parties, except when required to by law.</p>
                <p>Our website may link to external sites that are not operated by us. Please be aware that we have no control over the content and practices of these sites, and cannot accept responsibility or liability for their respective privacy policies.</p>
                <p>You are free to refuse our request for your personal information, with the understanding that we may be unable to provide you with some of your desired services.</p>
                <p>Your continued use of our website will be regarded as acceptance of our practices around privacy and personal information. If you have any questions about how we handle user data and personal information, feel free to contact us.</p>
                <p><strong>Data Controller:</strong> Bflash</p>
                <p><strong>Types of Data Collected:</strong> Username, Email, Crypted Password, Usage Data</p>
                <p><strong>Purpose of Processing:</strong> To provide and maintain service, To manage accounts, To enable features, For analytics</p>
                <p><strong>User Rights (GDPR):</strong> Users in the European Union have the right to access, rectify, erase, restrict processing, object to processing, and data portability regarding their personal data. To exercise these rights, please contact us.</p>
                 </div>
        </div>
    </div>
    
    <div id="terms-service-modal" class="modal" style="display: none;">
        <div class="modal-content legal-modal">
            <span class="close-modal" data-modal-id="terms-service-modal">&times;</span>
            <h2>Terms of Service</h2>
             <div class="modal-body">
                <p><strong>Last Updated: 04/05/2025</strong></p>
                <p>Please read these Terms of Service ("Terms", "Terms of Service") carefully before using the website (the "Service") operated by us.</p>
                <p>Your access to and use of the Service is conditioned on your acceptance of and compliance with these Terms. These Terms apply to all visitors, users and others who access or use the Service.</p>
                <p>By accessing or using the Service you agree to be bound by these Terms. If you disagree with any part of the terms then you may not access the Service.</p>
                <p><strong>Accounts:</strong> When you create an account with us, you must provide us information that is accurate, complete, and current at all times. Failure to do so constitutes a breach of the Terms, which may result in immediate termination of your account on our Service.</p>
                <p><strong>Content:</strong> Our Service allows you to post, link, store, share and otherwise make available certain information, text, graphics, videos, or other material ("Content"). You are responsible for the Content that you post to the Service, including its legality, reliability, and appropriateness.</p>
                <p><strong>Intellectual Property:</strong> The Service and its original content (excluding Content provided by users), features and functionality are and will remain the exclusive property of Bflash and its licensors.</p>
                <p><strong>Termination:</strong> We may terminate or suspend access to our Service immediately, without prior notice or liability, for any reason whatsoever, including without limitation if you breach the Terms.</p>
                <p><strong>Governing Law:</strong> These Terms shall be governed and construed in accordance with the laws of Italy, without regard to its conflict of law provisions.</p>
                <p><strong>Changes:</strong> We reserve the right, at our sole discretion, to modify or replace these Terms at any time.</p>
                <p><strong>Contact Us:</strong> If you have any questions about these Terms, please contact us at bflash@gmail.com</p>
                </div>
        </div>
    </div>
    
    <div id="cookie-policy-modal" class="modal" style="display: none;">
        <div class="modal-content legal-modal">
            <span class="close-modal" data-modal-id="cookie-policy-modal">&times;</span>
            <h2>Cookie Policy</h2>
             <div class="modal-body">
                 <p><strong>Last Updated: 04/05/2025</strong></p>
                 <p>This Cookie Policy explains what cookies are and how we Bflash use them on the website (the "Service"). You should read this policy so you can understand what type of cookies we use, the information we collect using cookies and how that information is used.</p>
                 <p><strong>What are cookies?</strong> Cookies are small text files that are stored on your browser or device by websites, apps, online media, and advertisements. They are widely used to 'remember' you and your preferences, either for a single visit (through a "session cookie") or for multiple repeat visits (using a "persistent cookie").</p>
                 <p><strong>How we use cookies:</strong> We use cookies for several purposes:</p>
                 <ul>
                     <li><strong>Essential Cookies:</strong> These cookies are necessary for the Service to function and cannot be switched off in our systems. They are usually only set in response to actions made by you which amount to a request for services, such as setting your privacy preferences, logging in or filling in forms (e.g., Session Cookies for login state).</li>
                     <li><strong>Functionality Cookies:</strong> These cookies enable the website to provide enhanced functionality and personalization. They may be set by us or by third party providers whose services we have added to our pages (e.g., remembering your theme preference).</li>
                     <li><strong>Analytics Cookies (if used):</strong> These cookies allow us to count visits and traffic sources so we can measure and improve the performance of our site. They help us to know which pages are the most and least popular and see how visitors move around the site. [Mention if data is aggregated/anonymized. List providers like Google Analytics if used].</li>
                     <li><strong>Advertising Cookies (if used):</strong> These cookies may be set through our site by our advertising partners.</li>
                 </ul>
                 <p><strong>Your Choices:</strong></p>
                 <p>When you first visit our site, you may be presented with a banner allowing you to accept or reject non-essential cookies. You can usually modify your browser setting to decline cookies if you prefer. However, this may prevent you from taking full advantage of the website. [Provide link to manage preferences if you have a consent tool].</p>
                 <p><strong>List of Cookies Used:</strong></p>
                 <ul>
                    <li>`token` (or similar session token cookie): Essential, used to keep you logged in. Type: Session/Persistent.</li>
                    <li>`themeMode`: Functionality, stores your light/dark mode preference. Type: Persistent (localStorage).</li>
                    <li>`_ga`, `_gid` (if using Google Analytics): Analytics cookies. Type: Persistent.</li>
                     </ul>
                 <p><strong>Changes to This Policy:</strong> We may update our Cookie Policy from time to time. We will notify you of any changes by posting the new Cookie Policy on this page.</p>
                 <p><strong>Contact Us:</strong> If you have any questions about this Cookie Policy, please contact us at Bflash.</p>
             </div>
        </div>
    </div>
    <script>
        // --- Constants and Global Variables ---
        const API_URL = '/api'; // Base API URL
        const token = localStorage.getItem('token'); // Get auth token
    
        // Redirect if not logged in
        if (!token) {
            // Ensure redirection happens only if not already on login page
            if (!window.location.pathname.endsWith('login.html')) {
                window.location.href = 'login.html';
            }
        }
    
        // --- DOM Elements ---
        const darkModeToggle = document.getElementById('dark-mode-toggle');
        // Add selectors for other settings elements if needed
        const profileForm = document.getElementById('profile-form');
        const profileBioInput = document.getElementById('profile-bio');
        const profileMessage = document.getElementById('profile-message');
        const passwordForm = document.getElementById('password-form');
        const currentPasswordInput = document.getElementById('current-password');
        const newPasswordInput = document.getElementById('new-password');
        const confirmPasswordInput = document.getElementById('confirm-password');
        const passwordMessage = document.getElementById('password-message');
        const deleteButton = document.getElementById('delete-account-button');
        const deleteMessage = document.getElementById('delete-message');
        const usernameDisplay = document.getElementById('username-display'); // For header
        const logoutButton = document.getElementById('logout-button'); // For header
        const profileButton = document.getElementById('profile-menu-button'); // For header
        const profileDropdown = document.getElementById('profile-dropdown'); // For header
        const profileUsernameInput = document.getElementById('profile-username'); // For profile username input
    
    
        // --- Theme Switching Logic ---
    
        /**
         * Applies the selected theme (light/dark) to the document root and saves the preference.
         * @param {string} theme - The theme to apply ('light' or 'dark').
         */
        function applyTheme(theme) {
          console.log(`Applying theme: ${theme}`);
          const isLight = theme === 'light';
    
          // Toggle the class on the root <html> element
          document.documentElement.classList.toggle('light-mode', isLight);
    
          // Update the toggle switch state visually
          if (darkModeToggle) {
            // Toggle should be CHECKED if the theme is LIGHT
            darkModeToggle.checked = isLight;
          }
    
          // Save the chosen theme preference to localStorage
          localStorage.setItem('themeMode', theme);
        }
    
        /**
         * Loads the theme preference from localStorage or defaults to dark mode,
         * then applies the theme and sets the toggle state.
         * This should ideally run *very* early, but we'll call it on DOMContentLoaded here
         * assuming the separate early script handles the initial flash prevention.
         */
        function loadAndApplyInitialTheme() {
          // Get saved theme, default to 'dark' if nothing is saved
          const savedTheme = localStorage.getItem('themeMode') || 'dark';
          console.log(`Loading initial theme for settings page: ${savedTheme}`);
          applyTheme(savedTheme); // Apply the loaded or default theme
        }
    
        // --- Utility to show messages ---
        function showMessage(element, text, isError = false) {
            if (!element) return; // Guard against null elements
            element.textContent = text;
            element.className = `message ${isError ? 'error' : 'success'}`;
            element.style.display = 'block';
            // Optionally hide after some time
             setTimeout(() => { element.style.display = 'none'; }, 5000);
        }
    
        // --- Load User Data (Example, adapt as needed) ---
        async function loadUserData() {
            if (!token) return; // Don't fetch if no token
            try {
                const response = await fetch(`${API_URL}/users/me`, {
                    headers: { 'x-auth-token': token }
                });
                if (!response.ok) {
                     if (response.status === 401) { // Handle unauthorized
                         localStorage.removeItem('token');
                         localStorage.removeItem('user');
                         window.location.href = 'login.html';
                         return;
                     }
                    throw new Error('Failed to load user data');
                }
                const user = await response.json();
    
                // Populate profile form
                if (profileUsernameInput) profileUsernameInput.value = user.username || '';
                if (profileBioInput) profileBioInput.value = user.profile?.bio || '';
                if (usernameDisplay) usernameDisplay.textContent = user.username || 'User';
    
                // Theme setting is handled by loadAndApplyInitialTheme
    
            } catch (error) {
                console.error("Error loading user data:", error);
                // Handle error display if needed (e.g., show a general error message)
            }
        }
    
    
        // --- Event Listeners ---
    
        // Listen for changes on the dark mode toggle switch
        if (darkModeToggle) {
            darkModeToggle.addEventListener('change', () => {
                // If the toggle is checked, the user wants light mode.
                // If it's unchecked, the user wants dark mode.
                const desiredTheme = darkModeToggle.checked ? 'light' : 'dark';
                applyTheme(desiredTheme);
            });
        } else {
            console.error("Dark mode toggle element not found!");
        }
    
        // Update Profile Form Submission
        if (profileForm) {
            profileForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                if (!token) return;

                const username = profileUsernameInput.value.trim();
                const bio = profileBioInput.value.trim();

                try {
                    const response = await fetch(`${API_URL}/users/me`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                            'x-auth-token': token
                        },
                        body: JSON.stringify({ username, bio })
                    });
                    const result = await response.json();
                    if (!response.ok) throw new Error(result.message || 'Failed to update profile');
                    showMessage(profileMessage, 'Profile updated successfully!');
                    loadUserData(); // Reload user data to reflect changes
                } catch (error) {
                    showMessage(profileMessage, error.message || 'Error updating profile', true);
                }
            });
        }
    
        // Change Password Form Submission
        if (passwordForm) {
            passwordForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                if (!token) return;
                const currentPassword = currentPasswordInput.value;
                const newPassword = newPasswordInput.value;
                const confirmPassword = confirmPasswordInput.value;
    
                // Basic validation
                if (!currentPassword || !newPassword || !confirmPassword) {
                     showMessage(passwordMessage, 'Please fill in all password fields.', true);
                     return;
                }
                if (newPassword !== confirmPassword) {
                    showMessage(passwordMessage, 'New passwords do not match.', true);
                    return;
                }
                if (newPassword.length < 6) {
                     showMessage(passwordMessage, 'New password must be at least 6 characters.', true);
                    return;
                }
    
                try {
                    const response = await fetch(`${API_URL}/users/me/password`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                            'x-auth-token': token
                        },
                        body: JSON.stringify({ currentPassword, newPassword })
                    });
                    const result = await response.json();
                     if (!response.ok) throw new Error(result.message || 'Failed to change password');
                    showMessage(passwordMessage, 'Password changed successfully!');
                     passwordForm.reset(); // Clear form
                } catch (error) {
                     showMessage(passwordMessage, error.message || 'Error changing password', true);
                }
            });
        }
    
        // Delete Account Button
        if (deleteButton) {
            deleteButton.addEventListener('click', async () => {
                if (!token) return;
                try {
                    // Fetch username for confirmation
                     const userResponse = await fetch(`${API_URL}/users/me`, { headers: { 'x-auth-token': token }});
                     if (!userResponse.ok) throw new Error("Could not verify username.");
                     const userData = await userResponse.json();
                     const currentUsername = userData.username;
    
                     const confirmation = prompt(`This action is permanent and cannot be undone. All your decks and cards will be lost. Type your username "${currentUsername}" to confirm deletion:`);
    
                     if (confirmation === null) return; // User cancelled
    
                     if (confirmation !== currentUsername) {
                         showMessage(deleteMessage, 'Username does not match. Account deletion cancelled.', true);
                         return;
                     }
    
                    // Proceed with deletion
                    const deleteResponse = await fetch(`${API_URL}/users/me`, {
                        method: 'DELETE',
                        headers: { 'x-auth-token': token }
                    });
                    const result = await deleteResponse.json();
                    if (!deleteResponse.ok) throw new Error(result.message || 'Failed to delete account');
    
                     alert('Account deleted successfully.'); // Alert before logout
                    // Logout user
                    localStorage.removeItem('token');
                    localStorage.removeItem('user');
                    window.location.href = 'login.html';
    
                } catch(error) {
                    showMessage(deleteMessage, error.message || 'Error deleting account', true);
                }
            });
        }
    
        // Profile Dropdown Menu
        if (profileButton && profileDropdown) {
            profileButton.addEventListener('click', () => {
                profileDropdown.style.display = profileDropdown.style.display === 'none' ? 'block' : 'none';
            });
            document.addEventListener('click', (e) => {
                // Close if clicked outside the button and the dropdown itself
                if (!profileButton.contains(e.target) && !profileDropdown.contains(e.target)) {
                    profileDropdown.style.display = 'none';
                }
            });
        }
    
        // Logout Button
        if (logoutButton) {
             logoutButton.addEventListener('click', () => {
                localStorage.removeItem('token');
                localStorage.removeItem('user');
                window.location.href = 'login.html';
            });
        }
    
    
        // --- Initial Setup on Page Load ---
        document.addEventListener('DOMContentLoaded', () => {
            if (!token) return; // Don't run setup if redirecting
            console.log("Settings page DOM loaded.");
            loadAndApplyInitialTheme(); // Set the theme FIRST
            loadUserData(); // Then load other user-specific data
            // Add calls to setup other event listeners if they weren't added above
        });

        // Add these within the <script> block at the end of settings.html

        // --- Get Modal Elements and Links ---
        const privacyModal = document.getElementById('privacy-policy-modal');
        const termsModal = document.getElementById('terms-service-modal');
        const cookieModal = document.getElementById('cookie-policy-modal');

        const privacyLink = document.getElementById('privacy-policy-link');
        const termsLink = document.getElementById('terms-service-link');
        const cookieLink = document.getElementById('cookie-policy-link');

        const closeButtons = document.querySelectorAll('.close-modal');

        // --- Function to Open a Modal ---
        function openModal(modalElement) {
            if (modalElement) {
                modalElement.style.display = "block";
                // Optional: Prevent body scrolling when modal is open
                // document.body.style.overflow = 'hidden';
            }
        }

        // --- Function to Close a Modal ---
        function closeModal(modalElement) {
            if (modalElement) {
                modalElement.style.display = "none";
                // Optional: Restore body scrolling
                // document.body.style.overflow = 'auto';
            }
        }

        // --- Event Listeners for Links ---
        if (privacyLink) {
            privacyLink.addEventListener('click', (e) => {
                e.preventDefault(); // Prevent default link behavior
                openModal(privacyModal);
            });
        }
        if (termsLink) {
            termsLink.addEventListener('click', (e) => {
                e.preventDefault();
                openModal(termsModal);
            });
        }
        if (cookieLink) {
            cookieLink.addEventListener('click', (e) => {
                e.preventDefault();
                openModal(cookieModal);
            });
        }

        // --- Event Listeners for Close Buttons ---
        closeButtons.forEach(button => {
            button.addEventListener('click', () => {
                const modalId = button.getAttribute('data-modal-id'); // Get the ID from data attribute
                const modalToClose = document.getElementById(modalId);
                closeModal(modalToClose);
            });
        });

        // --- Event Listener to Close Modal on Outside Click ---
        window.addEventListener('click', (event) => {
            if (event.target === privacyModal) {
                closeModal(privacyModal);
            }
            if (event.target === termsModal) {
                closeModal(termsModal);
            }
            if (event.target === cookieModal) {
                closeModal(cookieModal);
            }
        });

        // Optional: Close modal with Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === "Escape") {
                closeModal(privacyModal);
                closeModal(termsModal);
                closeModal(cookieModal);
            }
        });
    
    </script>

</body>
</html>